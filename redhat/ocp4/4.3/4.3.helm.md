# openshift 4.3 helm

https://docs.openshift.com/container-platform/4.3/cli_reference/helm_cli/getting-started-with-helm-on-openshift-container-platform.html

https://chartmuseum.com/docs/#installing-chartsinto-kubernetes

https://whmzsu.github.io/helm-doc-zh-cn/chart/chart_repository-zh_cn.html

## 环境准备

```bash

skopeo copy docker://docker.io/gogs/gogs docker://registry.redhat.ren:5443/docker.io/gogs/gogs

skopeo copy docker://docker.io/chartmuseum/chartmuseum:latest docker://registry.redhat.ren:5443/docker.io/chartmuseum/chartmuseum:latest

skopeo copy docker://docker.io/ananwaresystems/webarchive:1.0 docker://registry.redhat.ren:5443/docker.io/ananwaresystems/webarchive:1.0

skopeo copy docker://docker.io/tomcat:7.0 docker://registry.redhat.ren:5443/docker.io/tomcat:7.0 

# https://github.com/helm/charts/tree/master/stable/chartmuseum

mkdir -p /data/ocp4/helm/charts

podman run --rm -it \
  -p 18080:8080 \
  -v /data/ocp4/helm/charts:/charts:Z \
  -e DEBUG=true \
  -e STORAGE=local \
  -e STORAGE_LOCAL_ROOTDIR=/charts \
  --privileged \
  registry.redhat.ren:5443/docker.io/chartmuseum/chartmuseum:latest

curl -L https://mirror.openshift.com/pub/openshift-v4/clients/helm/latest/helm-linux-amd64 -o /usr/local/bin/helm

chmod +x /usr/local/bin/helm

helm version

helm repo add chartmuseum http://localhost:18080

cd /data/ocp4/helm/chartmuseum
helm package .
curl --data-binary "@chartmuseum-2.12.0.tgz" http://localhost:18080/api/charts
helm repo update
helm search repo

oc project demo
helm install example-chartmuseum chartmuseum/chartmuseum
helm list

helm uninstall example-chartmuseum
helm repo remove chartmuseum



```